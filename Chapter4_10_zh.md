## 4.10 数据库基础

数据库管理平台应该为应用程序员提供 ACID 事务的抽象，使他们不必担心可能由并发或故障引起的异常[19]。本节简要介绍通用关系数据库的基础知识。MySQL 的高级基础知识将在下一章中介绍。

### 4.10.1 关系模型和 SQL 语言

基于谓词逻辑和集合论的关系模型是数据库中的基本数据模型。SQL（结构化查询语言）是一种非常成功的编程语言，通过允许用户指定其需求而无需了解底层实现来简化数据库交互。

关系模型和 SQL 设计优雅。它们的发明需要重要的想象力来使用关系模型和 SQL 来解决数据存储问题，就像今天常见的那样。它们的成功很大程度上归功于它们的可扩展性和易用性。

SQL 相对容易使用，在数据库系统中被广泛接受。然而，与其他高级机器学习语言相比，它缺少一些复杂的处理模式（例如，迭代训练）。幸运的是，SQL 可以扩展以支持 AI 模型，并且可以设计用户友好的工具来支持 SQL 语句中的 AI 模型[55]。

使用 AI 生成 SQL 查询也是 SQL 继续发展的一个有前途的方向。

### 4.10.2 数据库安全

安全性和易用性通常为用户提供权衡，需要根据其需求做出相应的决定。为了增强安全性，MySQL 利用 TLS/SSL 加密通信，确保客户端-服务器交互被加密。这增加了安全性，但增加了问题分析的复杂性。例如，使用数据包嗅探工具捕获的加密 SQL 内容分析可能具有挑战性。

### 4.10.3 数据库完整性

数据库完整性是指数据库中数据的逻辑一致性、正确性、有效性和兼容性。它通过各种完整性约束来确保，使数据库完整性设计与这些约束的设计同义。

对于独立的 MySQL 实例，维护数据库完整性相对简单，相比在 Group Replication 多主模式中实现它。例如，如[13]中所述，Group Replication 不支持以下功能。

![](media/9cb7a536001ffe21d63ecc68e368b4a0.png)

### 4.10.4 SQL 重写

许多数据库用户，尤其是云中的用户，可能不会编写高质量的 SQL 查询。SQL 重写器旨在将这些查询转换为更有效的形式，例如下推过滤器或将嵌套查询转换为连接查询[55]。因此，将 SQL 查询转换为等效的高质量版本是一项非常有意义的工作。

### 4.10.5 SQL 注入

SQL 注入是数据库的常见且有害的漏洞。攻击者可以利用此漏洞通过绕过身份验证或干扰 SQL 语句来修改或查看超出其权限的数据，从而导致诸如检索隐藏数据、颠覆应用程序逻辑和执行联合攻击等操作[55]。

对于 MySQL，防止 SQL 注入涉及几种策略。除了使用加密通信外，用户还可以使用预处理语句来避免 SQL 注入。预处理语句确保 SQL 代码与数据输入分离，显著降低注入攻击的风险。

### 4.10.6 索引对性能的重大影响

在 DBMS 中，索引对于加速查询执行至关重要，选择适当的索引对于实现高性能至关重要[55]。以下是为 BenchmarkSQL TPC-C 测试创建的附加索引，在默认索引之上：

```
create index bmsql_oorder_index on bmsql_oorder (o_c_id);
```

创建附加索引是为了提高 TPC-C 吞吐量。下图显示了添加索引前后 TPC-C 吞吐量与并发之间的关系。

<img src="media/image-20240829090305653.png" alt="image-20240829090305653" style="zoom:150%;" />

图 4-68. 添加索引前后的 BenchmarkSQL 测试比较。

从图中可以看出，建立有效的索引可以显著提高 MySQL TPC-C 吞吐量。

### 4.10.7 状态机复制

提供高可用性服务的最通用方法是使用复制状态机架构。对于确定性服务，状态和功能在服务器之间复制，无界的共识实例序列同意执行的命令。这种方法提供强一致性保证，并且广泛适用[32]。

状态机复制是一种成熟的容错方法。它在多个服务器上复制服务，尽管服务器故障仍保持可用性。然而，它有两个性能限制：由于需要完全排序命令，它在响应时间中引入了开销，并且不能通过添加更多副本来增加服务吞吐量。

Group Replication 是状态机复制的实现。基于原生 MySQL 进行了广泛的修复和改进，显著增强了稳定性和性能。后续章节将详细介绍对 Group Replication 的这些改进。

[下一页](Chapter4_11_zh.md)
